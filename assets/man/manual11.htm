<html><body>
<h3>[11] SKETCH WINDOW</h3>

The first time you tap the Sketch button the dialog you get contains only the "New Sketch" button. Tap on it. The coming dialog contains two fields:
<ul>
<li>the sketch <u>name</u>. TopoDroid suggest a number, and you can safely leave it. The sketch filenames are obtained composing the survey name with the name in this field. For example if the survey is "MySurvey" and the sketch is "1", the plan filename is "MySurvey-1p.th2" and the profile filename is "MySurvey-1s.th2". They are placed in the directory "th2" of TopoDroid</li>
<li>the sketch <u>origin</u> station (base station). This is very important as all the sketch data will have coordinates relative to this station. You should choose a station that is inside the sketch, because, in order to keep the sketch as clean as possible, you can limit the midline display for the sketch not to go beyond certain stations (this mechanism is called "barrier". When editing a station you can mark it as a "barrier" to the midline display for the sketch. Stations beyond a "barrier" are not included in the Therion files.</li>
</ul><br><p>

It is also possible to hide pieces of midline between the origin station and other stations. These are called "hiding" stations.Stations names are shown in pink, barrier stations are red, and hiding stations are violet.<br><p>

<b>WARNING. The name of the sketch cannot contain the character '/' (slash), which is the pathname separator.</b><br><p>

So type in a station name, and tap the <u>OK</u> button.  And you go to the sketch window.<br><p>

Each sketch is made of two Therion 2D sketch files: one for the plan, the other for the profile. Of course you can draw cross sections, but we will get to them later. The sketch window opens with the plan by default.  Afterwards the sketch dialog shows two columns, and you can open a sketch starting either in the plan view or in the profile view. In any case TopoDroid is always opening the two sketch files, and just showing the one you choose.<br><p>

<i>Therion</i> scraps must have a scale defined or at least two stations (so that <i>Therion</i> can compute the scale). TopoDroid has an option to automatically add all the stations that fall in the convex hull of the sketch to the scrap. This is enabled by default. However this may not be convenient if you work with xtherion and stations from other portions of the survey fall inside the scrap so that you get many "spurious" point stations. In this case you might want to disable this option and decide by yourself which station to add to the scrap.<br><p>

<b>NOTE</b><br>
The first time you open a sketch TopoDroid loads the drawing tools (the palette). This may take some time if your Android is not powerful because the program has to read in many files (one for each tool). Afterwards opening a sketch is usually faster.<br><p>

You have not drawn anything yet, and the canvas will display a grid (each little square is 1 m, the big squares are 10 m), the midline (with both legs and splays), and the stations. These objects are the references to help you drawing the sketch. They are usually very handy however you can choose to hide any of them, if you want to focus on what you have drawn, for editing purposes.<br><p>

The sketch window has four modes:
</ul>
<li><b>move</b>, the default: you can shift the canvas, and zoom in/out. If the "fixed references" box in the references dialog is set, shifts affect only the drawings [level experimental]</li>
<li><b>draw</b>: in this mode you add iconic symbols (points, including labels), and trace lines and areas (closed regions filled with a color). At the basic level drawing is limited to lines.</li>
<li><b>erase</b>: to erase items, and lines/areas, or portions of them, from the sketch.</li>
<li><b>edit</b> [A]: for the fine editing. Shift and zoom are still available, as for the "move" mode.</li>
</ul><br><p>

Sketch shifting and zooming is possible even in <b>draw</b> and in <b>erase</b> mode using two fingers. If zoom controls are enabled they show up when you tap at the bottom of the canvas in the middle. Finally, in every mode, the sketch can be shifted by "dragging" on the left, right and bottom sides of the canvas.<br><p>

N.B. Erasing is a raster operation. The points of the vector items that come under the erased region are removed. This affects the undo stack in two ways: first erased items are dropped from the stack, second erasing the middle of a line remove the line object from the stack and replaces it with two lines that are added on the top of the stack.<br><p>

<h4>BUTTONS</h4>
The modes are represented by the three green buttons on the left: <u>draw</u>, <u>erase</u>, and <u>edit</u>. When none of them is "on" (has a white frame around) the mode is "move", otherwise it is that of the button that is "on".<br><p>

The remaining buttons differ by the mode. In the <b>move</b> mode they are
<ul>
<li><u>Download</u> downloads data from the DistoX. The latest downloaded shot are bluish to help you distinguish them from the others. If no DistoX is selected, this button is hidden.</li>
<li><u>Bluetooth</u>: Opens the Bluetooth dialog that allows you to control the laser, take a measurement and download it, and reset the BT connection. If you experience problems with the DistoX after downloading some data, you may try to reset the bluetooth connection on TopoDroid, switch the DistoX on and off, and retry downloading the data.</li>
<li><u>Reference</u>: to choose which reference to display. The drawing references are the midline, the splay shots, the station names, and the metric grid.</li>
<li><u>Plan/Profile</u> toggles between the sketch of the plan and that of the profile. Profile flip (long tap) [E].</li>
<li><u>Extend</u>: this is the same as the <u>Extend</u> button of the Survey Data window</li>
<li><u>Notes</u>: to edit the survey annotations</li>
</ul><br><p>

The <b>draw</b> mode has four buttons besides the green ones:
<ul>
<li><u>Undo</u> removes the last items you have drawn, one at a time.</li>
<li><u>Redo</u> puts the removed item back in the sketch, one at a time. The list of removed items is emptied when you draw something new. Pointwise editing actions may also affect the list of redo.</li>
<li><u>Drawing tool</u> picker. By default the tool picker lists the tool graphics and the name. Once you are used to the graphics, you can switch to the more compact grid view without the names, with the appropriate setting. You can farther limit the displayed tools, by disabling the ones you do not need through the "palette" menu.</li>
<li><u>Continuation</u> [N]. When this button is pressed a line started close to the end of another line of the same type is considered as its continuation and is attached to that. Note that a new line is not created, and "undoing" the drawing action removes the whole line.</li> 
</ul><br><p>

The <b>erase</b> mode has the <u>Undo</u> and <u>Redo</u> buttons. The erasing actions can be un-done and re-done just like any drawing actions. However, erasing can affects the position of a line in the list of undo's. Erasing the middle of a line drops the line from the list and puts the two end pieces at the end of the list. The "undo" removes the two pieces and puts the line at the end of the list.<br><p>

The <b>edit</b> [A] mode has four buttons besides the green ones:
<ul>
<li><u>Previous</u> to go to the previous point in the selection. To do some editing you must select a point (either a point, a line/area point, a station, or a shot midpoint). To do this you tap near the point you want; however if there are several points close by the result is a selection set containing several point, only one of them is the active editing point.  You move among them with the "Previous" and "Next" buttons.</li>
<li><u>Next</u> to go to the next point in the selection.</li>
<li><u>Point</u> (point-wise edit). Editing the item attributes and moving/editing the item point(s).</li>
<li><u>Item</u> (item-wise edit): with this button you edit item properties. For example for a label you can change the text.</li>
<li><u>Delete</u>: deletes the item from the sketch (it asks for confirmation, and can be "undone").</li>
</ul><br><p>

<h4>MENUS</h4>
<ul>
<li><u>Export</u>: the sketch can be exported as <i>Therion</i> 2D file(s), <i>cSurvey</i> (a single file), PNG (two files), DXF (two files), and SVG (two files). Sketches are stored in therion format. Exporting as <i>Therion</i> will save a backup copy. A backup copy is also made by TopoDroid when you switch sketch type. If you experience a problem with the opened sketch, try to recover it from the backup copy (<u>reload</u> menu). Cross-sections cannot be exported as cSurvey files<br>
PNG resolution can be increased if you get a too coarse image. You will get a larger and more detailed image, but this requires more CPU time and may fail due to memory limits. If it fails TopoDroid tries reducing the resolution until it succeeds.</li>
<li><u>Stats</u> displays some statistics (beware that these are limited to the extent of the data reduction of the sketch)</li>
<li><u>Reload</u>: to reload the sketch from the backup copy</li>
<li><u>Delete</u>: this marks the sketch as deleted. It can be later recovered as the sketch files are not actually deleted, nor the sketch record is dropped from the database table</li>
<li><u>Palette</u>: to choose the active drawing tools</li>
<li><u>Overview</u>: opens the overview window which shows all the survey sketches together.</li>
<li><u>Settings</u></li>
<li><u>Help</u></li>
</ul><br><p>

<h4>SKETCH STATISTICS [N]</h4>
The <i>Sketch Statistics</i> dialog displays the origin station (zero station), the survey length, the survey extension (East, West, North and South), the survey depths, both positive (above the zero station) and negative (below the zero station), the  number of stations, the number of shots (regular, duplicate, and surface), the number of splays, and the number of loops.
<br><p>


<h4>SKETCH SETTINGS</h4>
<ul>
  <li><i>Drawing tool picker</i>: either list view or grid view. At the beginning it may be helpful to have a tool picker listing the drawing tool names [default]. After you get used to the tool icons you are likely to prefer the more compact view of the grid picker.</li>
  <li><i>Side drag</i>: whether to enable panning by side-dragging.</li>
  <li><i>Zoom controls</i>: specifies whether and how zoom controls are displayed on multitouch devices [B]. The zoom controls can be hidden, displayed only for a short interval when the user tap the lower part of the screen in the middle, or shown all the time.</li>
  <li><i>Splay plan-view threshold</i>: splay shots with inclination above this threshold are hidden in the plan-view</li>
  <li><i>Splay dash threshold</i>: splay shots with inclination above this threshold are drawn with a dashed line</li>
  <li><i>Cross-section H-threshold</i>: the inclination angle above which a cross-section is horizontal. (Below it cross-section are vertical).</li>
  <li><i>Midline check</i>: whether to check if all the legs are attached to the midline</li>
  <li><i>DRAWING TOOLS >></i>
    <ul style="margin-top:0; margin-bottom:0">
    <li><i>Line style</i>. TopoDroid has four line styles. With the normal style [default] the lines are drawn as polylines. With the fine style the polyline segments are shorter, while with the coarse style they are longer. In the fourth style lines are interpolated replacing the segments with cubic Bezier curves. These segments pass through the two endpoints and have two control points used define the curvature.</li>
    <li><i>Line point spacing</i>: this is the distance between line points in the normal style [default 5 pxl] </li>
    <li><i>Bezier accuracy</i> determines the number of base points in the interpolating curve. The smaller the more points. The default value is 1.0.</li>
    <li><i>Bezier corner</i>. Even an interpolated line should have corners, when there is a sharp turn at a point. Small values (0.2) make the corner sharper. Large values (20.0) make them rounded.</li>
    </ul>
  </li>
  <li><i>SKETCH ITEMS >></i>
    <ul style="margin-top:0; margin-bottom:0">
    <li><i>Point tools scale</i>: the base scale of point symbols [N]</li>
    <li><i>Line width</i>: the base thickness of drawing lines</li>
    <li><i>Non-zoomed point</i>: whether point items should remain of fixed size when the drawing is zoomed</li>
    <li><i>Survey line width</i>: the base thickness of midline/splay lines</li>
    <li><i>Station name size</i>: size of stations names [default 18 pt] [N]</li>
    <li><i>Labels size</i>: size of label texts [default 24 pt]</li>
    <li><i>Section-line tick size</i>: length of the direction "tick" line in cross-section lines [default 5 pxl]</li>
    <li><i>Green dots radius</i>: size of the green dots displayed in <b>edit</b> mode [default 5 pxl] [N]</li>
    <li><i>Selection radius</i>: the range within which points are selected when fine-editing a sketch; [default 16 pxl]</li>
    </ul>
  </li>
  <li><i>AUTO WALLS [E] >></i>
    <ul style="margin-top:0; margin-bottom:0">
    <li><i>Walls type</i>: the type of auto-walls. Default is "none" (disabled).</li>
    <li><i>Splay plan threshold</i>: inclination threshold for using splays in auto-walls in the plan view.</li>
    <li><i>Splay profile threshold</i>: inclination threshold for using splays in auto-walls in the profile view.</li>
    <li><i>Point separation</i>: minimum separation of splay points along the shot direction. If two splays are closer than this value only the soplay with largest distance from the shot is used.</li>
    <li><i>Point step</i>: maximum distance along the walls between two line-points. If a wall segment connecting two splays is too long it is splitted interpolating points</li>
    <li><i>Concavity</i>: amount of accetped concavity.</li>
    </ul>
  </li>
</ul>

<h4>SKETCH SHIFT [E]</h4>
You can shift the drawing as a whole by selecting the "Fix ref" checkbox in the sketch reference dialog. Then in "move/zoom" mode the drawing can be shifted by dragging it with two fingers.<br><p>


<h4>PROFILE FLIP [E]</h4>
When viewing the profile, a long tap on the "Plan/Profile" button opens a confirmation dialog to flip the profile sketch horizontally. The dialog has a checkbox to reverse the extend direction of the shots as well. This is enabled by default. Only the shots up to the "barrier" stations, are reversed. In particular shots hidden by "hiding" stations are reversed. Therefore if you want to reverse only a portion of the shots you should first set "barrier" stations.<br><p>

<h4>BACKUP COPIES</h4>
TopoDroid keep a set of four backup copies for each sketch file. These are named with suffixes "bck", "bck0", "bck1", and "bck2" and are stored in the <i>th2</i> subdirectory. Whenever a sketch is saved the backup copies are rotated (eg, "bck1" is renamed "bck2", and so on; "bck" is renamed "bck0"), the old "th2" file is renamed with suffix "bck", and the sketch is saved to a new "th2" file.<br><p>

TopoDroid saves a sketch whenever it is modified (eg, a new item is added, or part of the sketch is erased) while it is open. Only one backup is used in this case: the old saved copy being renamed with suffix "bck".<br><p>

The sketch is saved only if you have made changes to it, otherwise it is not saved and the backup copies are not rotated.<br><p>

When you need to recover a sketch you can choose which copy to load. The dialog displays the backup files and their sizes. Select the backup copy and tap the "OK" button.<br><p>

<b>Warning. If the sketch disappear from the display, switch between plan and profile to force TopoDroid to reload it.</b><br><p>


<hr>
<i>To start drawing select the <b>draw</b> mode (green pencil button) and trace lines with your finger. If you make a mistake you can cancel the whole line with the <u>undo</u> button, or switch to the <u>erase</u> mode.  The drawing is saved in a pair of <i>Therion</i> files when you exit the sketch window. Each cross-section is saved in a single separate Therion file.</i><br><p>

<a href="manual10.htm"><img src="ic_back.png"></a>
<a href="manual12.htm"><img src="ic_forw.png"></a>

</body></html>
